<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>CryptoZombies</title>

        <script type="text/javascript" src="scripts/zombie.js"></script>
        <script type="text/javascript" src="scripts/web3.min.js"></script>
        <script type="text/javascript" src="scripts/jquery-3.2.1.min.js"></script>

        <script type="text/javascript">
            if (typeof window.web3 !== "undefined" && typeof window.web3.currentProvider !== "undefined") {
                var web3 = new Web3(window.web3.currentProvider);
            } else {
                var web3 = new Web3();
            }
        </script>

        <script type="text/javascript">
            // some sort of event listener to take the text input:
            /*$("span").click(function (e) {*/
            function _do() {
                var name = $("#nameInput").val();

                _input(name);
            }
            /*});*/
        </script>

        <script type="text/javascript">
            // Here's how we would access our contract:
            var abi = [{ "constant": true, "inputs": [{ "name": "", "type": "uint256" }], "name": "zombies", "outputs": [{ "name": "name", "type": "string" }, { "name": "dna", "type": "uint256" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [{ "name": "_name", "type": "string" }], "name": "createRandomZombie", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "anonymous": false, "inputs": [{ "indexed": false, "name": "zombieId", "type": "uint256" }, { "indexed": false, "name": "name", "type": "string" }, { "indexed": false, "name": "dna", "type": "uint256" }], "name": "NewZombie", "type": "event" }] /* abi generated by the compiler */

            var ZombieFactoryContract = web3.eth.contract(abi);

            var contractAddress = "0x0AB38201f5DBa309699880Fd0A6C0aF25641Cae0"; /* our contract address on Ethereum after deploying */

            // `ZombieFactory` has access to our contract's public functions and events
            var ZombieFactory = ZombieFactoryContract.at(contractAddress);

            /*var zombiefactory = zombiefactoryContract.new({
                from: web3.eth.accounts[0],
                data: '0x60606040526010600055600054600a0a600155341561001d57600080fd5b6104db8061002c6000396000f30060606040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680632052465e146100515780637bff0a0114610111575b600080fd5b341561005c57600080fd5b610072600480803590602001909190505061016e565b60405180806020018381526020018281038252848181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156101015780601f106100d657610100808354040283529160200191610101565b820191906000526020600020905b8154815290600101906020018083116100e457829003601f168201915b5050935050505060405180910390f35b341561011c57600080fd5b61016c600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506101a0565b005b60028181548110151561017d57fe5b906000526020600020906002020160009150905080600001908060010154905082565b60006101ab826101bb565b90506101b7828261023d565b5050565b600080826040518082805190602001908083835b6020831015156101f457805182526020820191506020810190506020830392506101cf565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390206001900490506001548181151561023457fe5b06915050919050565b6000600280548060010182816102539190610359565b916000526020600020906002020160006040805190810160405280878152602001868152509091909150600082015181600001908051906020019061029992919061038b565b5060208201518160010155505090507f88f026aacbbecc90c18411df4b1185fd8d9be2470f1962f192bf84a27d0704b78184846040518084815260200180602001838152602001828103825284818151815260200191508051906020019080838360005b838110156103185780820151818401526020810190506102fd565b50505050905090810190601f1680156103455780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a1505050565b81548183558181151161038657600202816002028360005260206000209182019101610385919061040b565b5b505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106103cc57805160ff19168380011785556103fa565b828001600101855582156103fa579182015b828111156103f95782518255916020019190600101906103de565b5b5090506104079190610442565b5090565b61043f91905b8082111561043b576000808201600061042a9190610467565b600182016000905550600201610411565b5090565b90565b61046491905b80821115610460576000816000905550600101610448565b5090565b90565b50805460018160011615610100020316600290046000825580601f1061048d57506104ac565b601f0160209004906000526020600020908101906104ab9190610442565b5b505600a165627a7a72305820a516d8430940635c8e8819cc296db4fd342b062d7c291b024446fe118ff5157f0029',
                gas: '4700000'
            }, function (e, contract) {
                console.log(e, contract);
            
                if (typeof contract.address !== 'undefined') {
                    console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                }
            });*/

            // Listen for the `NewZombie` event, and update the UI
            var event = ZombieFactory.NewZombie(function (error, result) {
                if (error) return

                generateZombie(result.zombieId, result.name, result.dna)
            })
        </script>
    </head>

    <body>
        <div id="main">
            <input type="text" id="nameInput" value="Crypty the Crypto Zombie">
            
            <p>Click for
                <button onclick="_do()">CryptoZombies</button>
            </p>
        </div>
    </body>
</html>